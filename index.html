<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <title>AR.js Video on Image Marker</title>
  <!-- Подключаем A-Frame и AR.js -->
  <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js@3.3.2/aframe/build/aframe-ar.js"></script>
</head>
<body style="margin: 0; overflow: hidden;">
  <!-- Включаем отладочный UI и расширенный поиск маркеров по всей области -->
  <a-scene 
    embedded
    vr-mode-ui="enabled: false"
    arjs="
      sourceType: webcam;
      debugUIEnabled: true;
      markersAreaEnabled: true;
    "
  >
    <a-assets>
      <!-- Видео должно называться точно vid.mp4 -->
      <video id="video" src="vid.mp4" loop preload="auto" webkit-playsinline playsinline muted crossorigin="anonymous"></video>
    </a-assets>

    <!-- Сначала проверяем с Hiro-маркером -->
    <a-marker preset="hiro">
      <a-box position="0 0.5 0" material="color: yellow;"></a-box>
    </a-marker>

    <!-- После успешной проверки раскомментируйте и используйте блок ниже -->
    <!--
    <a-marker type="pattern" url="marker.patt">
      <a-video 
        src="#video" 
        width="1" height="0.75" 
        position="0 0 0" 
        rotation="-90 0 0"
        material="shader: flat; side: double;"
      ></a-video>
    </a-marker>
    -->

    <a-entity camera></a-entity>
  </a-scene>

  <script>
    const marker = document.querySelector('a-marker');
    const video = document.querySelector('#video');
    marker.addEventListener('markerFound', () => {
      console.log('marker found, play video');
      video.play().catch(e => console.warn('Не удалось запустить видео:', e));
    });
    marker.addEventListener('markerLost', () => {
      console.log('marker lost, pause video');
      video.pause();
    });
  </script>
</body>
</html>
